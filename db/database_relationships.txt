# DATABASE RELATIONSHIPS DOCUMENTATION
# ===============================

## OVERVIEW
This document provides a comprehensive overview of all tables in the salon application database
and their relationships with each other.

## DATABASE TABLES SUMMARY
The database consists of 8 tables:
1. customers
2. staff
3. service_categories
4. services
5. appointments
6. feedback
7. promotions
8. knowledge_base

## DETAILED TABLE INFORMATION

### 1. CUSTOMERS TABLE
Columns:
- id (integer, PK)
- name (character varying, NOT NULL)
- phone (character varying, NOT NULL, UNIQUE)
- email (character varying, NOT NULL, UNIQUE)
- type (USER-DEFINED ENUM)
- preferences (json)
- loyalty_points (integer)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)

Relationships:
- Referenced by:
  * appointments.customer_id → customers.id
  * feedback.customer_id → customers.id

### 2. STAFF TABLE
Columns:
- id (integer, PK)
- name (character varying, NOT NULL)
- role (character varying, NOT NULL)
- skills (json)
- is_active (boolean)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)

Relationships:
- Referenced by:
  * appointments.staff_id → staff.id

### 3. SERVICE_CATEGORIES TABLE
Columns:
- id (integer, PK)
- name (character varying, NOT NULL, UNIQUE)
- description (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)

Relationships:
- Referenced by:
  * services.category_id → service_categories.id

### 4. SERVICES TABLE
Columns:
- id (integer, PK)
- name (character varying, NOT NULL, UNIQUE)
- price (double precision, NOT NULL)
- duration (integer, NOT NULL)
- description (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- duration_minutes (integer, NOT NULL, DEFAULT 60)
- category_id (integer, FK)

Relationships:
- References:
  * services.category_id → service_categories.id
- Referenced by:
  * appointments.service_id → services.id
  * promotions.service_id → services.id

### 5. APPOINTMENTS TABLE
Columns:
- id (integer, PK)
- customer_id (integer, FK, NOT NULL)
- service_id (integer, FK, NOT NULL)
- staff_id (integer, FK)
- appointment_time (timestamp with time zone, NOT NULL)
- status (USER-DEFINED ENUM)
- notes (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)

Relationships:
- References:
  * appointments.customer_id → customers.id
  * appointments.service_id → services.id
  * appointments.staff_id → staff.id
- Referenced by:
  * feedback.appointment_id → appointments.id

### 6. FEEDBACK TABLE
Columns:
- id (integer, PK)
- appointment_id (integer, FK, UNIQUE)
- customer_id (integer, FK)
- rating (integer, NOT NULL)
- comments (text)
- sentiment_score (double precision)
- created_at (timestamp with time zone)

Relationships:
- References:
  * feedback.appointment_id → appointments.id
  * feedback.customer_id → customers.id

### 7. PROMOTIONS TABLE
Columns:
- id (integer, PK)
- title (character varying, NOT NULL)
- description (text)
- discount_percent (double precision, NOT NULL)
- valid_from (timestamp with time zone, NOT NULL)
- valid_till (timestamp with time zone, NOT NULL)
- is_active (boolean)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- start_date (timestamp with time zone, NOT NULL)
- service_id (integer, FK)
- end_date (timestamp with time zone)

Relationships:
- References:
  * promotions.service_id → services.id

### 8. KNOWLEDGE_BASE TABLE
Columns:
- id (integer, PK)
- question (character varying, NOT NULL)
- answer (text, NOT NULL)
- category (character varying)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)

Relationships:
- None (standalone table)

## SUMMARY OF ALL RELATIONSHIPS

1. appointments.customer_id → customers.id
2. appointments.service_id → services.id
3. appointments.staff_id → staff.id
4. feedback.appointment_id → appointments.id
5. feedback.customer_id → customers.id
6. promotions.service_id → services.id
7. services.category_id → service_categories.id

## ENTITY RELATIONSHIP DIAGRAM (CONCEPTUAL)

```
                                  +----------------+
                                  | Knowledge Base |
                                  +----------------+
                                  (Standalone table)

+-------------------+        +-------------+        +-------------------+
| Service Categories|<-------| Services    |------->| Promotions        |
+-------------------+        +-------------+        +-------------------+
         ^                         ^
         |                         |
         |                         |
         |                   +-------------+        +-------------+
         |                   | Appointments|------->| Feedback    |
         |                   +-------------+        +-------------+
         |                         ^                      ^
         |                         |                      |
         |                         |                      |
         |                    +----------+                |
         +--------------------|  Staff   |                |
                              +----------+                |
                                   ^                      |
                                   |                      |
                              +----------+                |
                              | Customers|<---------------+
                              +----------+
```

## KEY OBSERVATIONS

1. Central Tables: 
   - Appointments is a central table connecting customers, staff, and services
   - Services connects to both service categories and promotions

2. One-to-Many Relationships:
   - One customer can have many appointments and feedback entries
   - One staff member can handle many appointments
   - One service category can have many services
   - One service can have many appointments and promotions

3. Feedback Relationship:
   - Each appointment can have at most one feedback entry (one-to-one relationship)
   - Feedback is linked to both the appointment and the customer

4. Standalone Table:
   - The knowledge base table has no relationships with other tables

This database structure follows a well-designed relational model for a salon management system,
with clear relationships between entities that reflect the business logic of appointment booking,
service management, and customer feedback. 